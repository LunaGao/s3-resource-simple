resource_types:
- name: s3-resource-type
  type: docker-image
  source:
    repository: maomishen/s3-resource-simple
resources:
- name: s3-resource
  type: s3-resource-type
  source:
    access_key_id: ((s3_access_key_id))
    secret_access_key: ((s3_secret_access_key))
    bucket: {{bucket}}

jobs:
- name: test-s3
  plan:
  - get: s3-resource
    # trigger: true
  - task: trigger_test
    config:
      inputs:
      - name: s3-resource
      run:
        path: sh
        args:
        - -exc
        - | 
          ls
          echo "aaa" >> abc.json
          ls
          mkdir put-resource
          for element in `ls s3-resource`
          do
             cp s3-resource/$element put-resource/$element
          done
      outputs:
      - name: put-resource
  - put: put-resource
    resource: s3-resource